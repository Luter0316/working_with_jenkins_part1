# Работа с системой непрерывной интеграции Jenkins

## Требуемые условия завершения

Перед началом выполнения задания рекомендуется ознакомиться со [статьёй](https://www.jenkins.io/doc/book/pipeline/getting-started/).

## I. Создание репозитория с исходными текстами примера

1. Создайте общедоступный Git-репозиторий в своём аккаунте на GitHub.
2. Склонируйте созданный репозиторий и заполните его файлами проекта, приложенного к данному заданию.
3. Настройте `.gitignore` таким образом, чтобы временные файлы (с суффиксом ~), служебные файлы Gradle (каталог `.gradle`) и файлы сборки (каталог build) игнорировались системой управления версиями.
4. Отправьте изменения в удалённый репозиторий.

## II. Регистрация в системе

1. Откройте веб-интерфейс системы непрерывного развёртывания Jenkins по адресу [jenkins.ivt.yarsu.ru](http://jenkins.ivt.yarsu.ru/).
2. Выберите пункт Create an account и создайте учётную запись с именем пользователя, совпадающим с вашим логином в Moodle (если в имени есть точка, её нужно опустить). По окончании регистрации вход в систему будет осуществлён автоматически.

## III. Сборка и выполнение тестов на сервере непрерывной интеграции

1. Создайте проект (job) в Jenkins, предназначенный для сборки проекта и выполнения тестов с помощью gradle wrapper. **Название проекта должно иметь в качестве префикса Ваш логин в Jenkins**. Для создания проекта необходимо использовать пункты меню *«New item — Freestyle project»*, а затем в разделе настроек проекта отметить *«Source code management — Git» (и ввести URL Вашего репозитория)* и *«Build — add build step — invoke Gradle script»*. Обратите внимание, что поскольку сборка происходит под Linux, то необходимо включить опцию *Make gradlew executable*.
2. Запустите сборку созданного проекта и добейтесь, чтобы она выполнялась без ошибок. Для отладки используйте консоль сборки, к которой можно перейти по ссылке *Console Output*, находящейся на странице сборки.
3. Запишите номер успешно выполненной сборки, заключающей в себе результаты выполнения задания.
4. Добавьте к созданному проекту шаг публикации результатов тестов (*«Post-build actions — Publish JUnit test results report»*). Для этого потребуется указать путь к XML-файлам отчётов о тестировании относительно корня рабочего пространства (workspace) проекта. Внимательно читайте подсказки в пользовательском интерфейсе Jenkins. По умолчанию XML-файлы находятся в каталоге `build/test-results/test/`.
5. Запустите сборку созданного проекта и добейтесь, чтобы она выполнялась без ошибок. Убедитесь, что результаты тестов отображаются на странице сборки.
6. Запишите номер успешно выполненной сборки, заключающей в себе результаты выполнения задания.

## IV. Отображение результатов тестов и детекция ошибок

1. Внесите в исходные коды проекта (не в тесты!) ошибку, которая не будет препятствовать компиляции, однако обеспечит неправильное поведение этого кода.
2. Зафиксируйте изменения и отправьте их в удалённый репозиторий.
3. Запустите сборку проекта в Jenkins и убедитесь, что она завешается неудачей. Убедитесь, что причиной неудачи являются ошибки при выполнении тестов.
4. Запишите номер неуспешно выполенной сборки, заключающей в себе результаты выполнения задания.
5. Отмените изменения в репозитории, внесённые на шаге 1, с помощью используемой системы управления версиями. В результате в истории должен появится соответствующий коммит с отменой изменений.
6. Запишите команду, в результате которой был выполнен предыдущий пункт задания.
7. Отправьте изменения в удалённый репозиторий. Запустите сборку созданного проекта и убедитесь, что она выполняется без ошибок.
8. Запишите номер успешно выполненной сборки, заключающей в себе результаты выполнения задания.

## V. Выявление недостаточности покрытия кода тестами с помощью JaCoCo

1. Подключите к gradle-проекту [плагин JaCoCo](https://docs.gradle.org/current/userguide/jacoco_plugin.html), позволяющий выяснять, какие строки программного кода выполнялись в ходе тестов, а какие — нет.
2. Зафиксируйте изменения и отправьте их в удалённый репозиторий.
3. Настройте для Jenkins-проекта вывод статистики покрытия кода тестами с помощью [плагина JaCoCo для Jenkins](https://plugins.jenkins.io/jacoco). При настройке плагина обратите внимание на то, что статистика по коду самих тестов не должна выводиться пользователю.
4. Запустите сборку проекта и добейтесь, чтобы она выполнялась без ошибок.
5. Запишите номер успешно выполненной сборки, заключающей в себе результаты выполнения задания.
6. Изучите статистику покрытия и добавьте в проект дополнительные тесты, в которых будет выполняться код, отображаемый в статистике как непокрытый.
7. Зафиксируйте изменения и отправьте их в удалённый репозиторий.
8. Запустите сборку проекта и добейтесь, чтобы она выполнялась без ошибок.
9. Запишите номер успешно выполненной сборки, заключающей в себе результаты выполнения задания.

## Сдача работы

Укажите в текстовом поле для ввода результатов выполнения задания следующую информацию:

* URL созданного проекта в Jenkins;
* номер успешной сборки с шага III.3;
* номер успешной сборки с шага III.6;
* номер неуспешной сборки с шага IV.4
* команда отмены изменений с шага IV.6;
* номер успешной сборки с шага IV.8;
* номер успешной сборки с шага V.5;
* номер успешной сборки с шага V.9.
